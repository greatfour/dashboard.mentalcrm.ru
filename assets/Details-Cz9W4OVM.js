import{d as S,u as I,g as B,i as tt,k as y,n as et,o as n,c as w,e,w as a,f as $,t as o,b as s,V as h,af as W,aE as st,a as t,ak as lt,ad as H,I as P,an as at,aK as F,aF as ot,J as it,al as nt,F as M,r as C,h as U,p as N,B as Y,m as j,aL as rt,ah as z,ag as D}from"./index-D2tFxEgP.js";import{h as q}from"./moment-zH0z38ay.js";import{_ as ct}from"./DeleteModal.vue_vue_type_script_setup_true_lang-C78xVUAY.js";import{u as ut}from"./Rules-BG1yOtK0.js";import{u as E}from"./Client-D0Y0OEjf.js";import{_ as dt}from"./BaseLoader.vue_vue_type_script_setup_true_lang-BxgJmsTp.js";import{_ as L}from"./BaseCard.vue_vue_type_script_setup_true_lang-DgdVNY0D.js";import{a as mt,_ as ft}from"./SessionsWidget.vue_vue_type_script_setup_true_lang-XpEErI4R.js";import{_ as wt}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-CuVbhYNy.js";import{_ as _t,u as pt}from"./RecordingModal.vue_vue_type_script_setup_true_lang-HIZtnwhI.js";import{u as vt}from"./Notes-C9oFSAST.js";import{u as gt}from"./Sessions-DW_fmuRD.js";import{u as yt}from"./Billing-DqHmZn5L.js";import{u as bt}from"./Materials-CD2GhBwt.js";const xt={class:"title text-white"},ht={class:"tw-mb-1 tw-text-sm"},$t={class:"tw-mb-3 tw-flex"},Vt={class:"tw-mb-1 tw-text-sm"},Tt={class:"tw-mb-3 tw-flex"},kt={class:"tw-mb-1 tw-text-sm"},Dt={class:"tw-flex"},Nt=S({__name:"TagsModal",setup(c){const{t:l}=I(),u=B(),g=tt(),i=E(),{emptyRules:m}=ut(),_=y(!1),f=y(!1),d=y(""),p=y(null),V=y(!1),T=y(!1),b=y(!1),R=y(!1),O=y(!1),k=y([]),K=y([()=>k.value.length<10||l("validation.limitTag"),x=>i.tagsList.every(r=>r.name!==x)||l("validation.repeatTag")]),A=et(()=>i.tagsList.map(x=>({title:x.name,props:{value:x.id}}))),J=async()=>{R.value=!0;try{await i.createTagApi({title:d.value}),g.createNotification({title:l("notification.tagCreate"),color:"success"}),d.value=""}catch{g.createNotification({title:l("notification.errorNotification"),color:"error"})}R.value=!1},Q=async()=>{b.value=!0;try{await i.changeTagApi(Number(u.query.id),k.value),await i.getClientsDetails(Number(u.query.id)),k.value=i.clientDetails.tags.list.map(x=>x.id),g.createNotification({title:l("notification.clientTagCreate"),color:"success"})}catch{g.createNotification({title:l("notification.errorNotification"),color:"error"})}b.value=!1},G=async()=>{if(O.value=!0,p.value)try{await i.deleteTagsApi(p.value),await i.getClientsDetails(Number(u.query.id)),await i.getTags(),k.value=i.clientDetails.tags.list.map(x=>x.id),g.createNotification({title:l("notification.tagDelete"),color:"success"}),f.value=!1,p.value=null}catch{g.createNotification({title:l("notification.errorNotification"),color:"error"})}O.value=!1};return i.getClientsDetails(Number(u.query.id)).then(()=>{k.value=i.clientDetails.tags.list.map(x=>x.id)}),(x,r)=>{const X=C("PlusIcon"),Z=C("TrashIcon");return n(),w(M,null,[e(h,{onClick:r[0]||(r[0]=v=>_.value=!0),color:"primary"},{default:a(()=>[$(o(s(l)("client.tags")),1)]),_:1}),e(nt,{modelValue:_.value,"onUpdate:modelValue":r[8]||(r[8]=v=>_.value=v),width:"800"},{default:a(()=>[e(W,null,{default:a(()=>[e(st,{class:"pa-4 bg-primary"},{default:a(()=>[t("p",xt,o(s(l)("client.tags")),1)]),_:1}),e(lt,{class:"pa-4"},{default:a(()=>[t("div",null,[t("p",ht,o(s(l)("client.addTagsTitle")),1),e(H,{onSubmit:P(J,["prevent"]),modelValue:V.value,"onUpdate:modelValue":r[2]||(r[2]=v=>V.value=v),"lazy-validation":""},{default:a(()=>[t("div",$t,[e(at,{modelValue:d.value,"onUpdate:modelValue":r[1]||(r[1]=v=>d.value=v),modelModifiers:{trim:!0},rules:K.value,class:"tw-mr-3",variant:"outlined",required:""},null,8,["modelValue","rules"]),e(h,{loading:R.value,disabled:!V.value,type:"submit",color:"primary",icon:""},{default:a(()=>[e(X)]),_:1},8,["loading","disabled"])])]),_:1},8,["modelValue"])]),t("div",null,[t("p",Vt,o(s(l)("client.deleteTagsTitle")),1),e(H,{onSubmit:r[4]||(r[4]=P(v=>f.value=!0,["prevent"])),modelValue:T.value,"onUpdate:modelValue":r[5]||(r[5]=v=>T.value=v),"lazy-validation":""},{default:a(()=>[t("div",Tt,[e(F,{modelValue:p.value,"onUpdate:modelValue":r[3]||(r[3]=v=>p.value=v),rules:s(m),items:A.value,class:"tw-mr-3",variant:"outlined",required:""},null,8,["modelValue","rules","items"]),e(h,{disabled:!T.value,type:"submit",color:"error",icon:""},{default:a(()=>[e(Z)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]),t("div",null,[t("p",kt,o(s(l)("client.clientTagsTitle")),1),t("div",Dt,[e(F,{modelValue:k.value,"onUpdate:modelValue":r[6]||(r[6]=v=>k.value=v),items:A.value,variant:"outlined",color:"primary","hide-details":"",multiple:"",chips:"",clearable:"","closable-chips":""},null,8,["modelValue","items"])])])]),_:1}),e(ot,{class:"pa-4"},{default:a(()=>[e(it),e(h,{color:"error",onClick:r[7]||(r[7]=v=>_.value=!1)},{default:a(()=>[$(o(s(l)("cancel")),1)]),_:1}),e(h,{onClick:Q,loading:b.value,disabled:!1,color:"primary",variant:"flat"},{default:a(()=>[$(o(s(l)("save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ct,{modelValue:f.value,"onUpdate:modelValue":r[9]||(r[9]=v=>f.value=v),onDelete:G,title:s(l)("client.deleteTag"),loading:O.value,question:s(l)("client.deleteTagQuestion")},null,8,["modelValue","title","loading","question"])],64)}}}),Mt={class:"tw-flex tw-flex-col"},Ct={class:"tw-mb-10 tw-flex tw-items-center tw-justify-between"},qt={class:"tw-text-xl tw-font-semibold"},St={key:0,class:"tw-mb-4 tw-flex"},It={class:"tw-mb-4 tw-text-xs tw-text-slate-500"},Rt={class:"tw-mb-6 tw-truncate tw-text-base"},Bt={key:1},jt={class:"tw-text-lg"},Ut=S({__name:"NotesWidget",props:{notes:{default(){return[]},type:Object},total:{default:0,type:Number}},setup(c){const{t:l}=I(),u=B(),g=U(),i=m=>{g.push({name:m,query:{id:u.query.id}})};return(m,_)=>{const f=C("perfect-scrollbar");return n(),N(L,{class:"tw-relative tw-h-full"},{default:a(()=>[t("div",Mt,[t("div",Ct,[t("p",qt,o(s(l)("client.notesTitle")),1),t("div",null,[e(h,{onClick:_[0]||(_[0]=d=>i("Notes")),color:"primary",variant:"tonal"},{default:a(()=>[$(o(s(l)("client.showMore")),1)]),_:1})])]),e(f,null,{default:a(()=>[t("div",null,[c.total?(n(),w("div",St,[(n(!0),w(M,null,Y(c.notes,d=>(n(),w("div",{key:d.title,class:"tw-mr-3 tw-min-w-44 tw-max-w-40 tw-rounded-lg tw-bg-slate-50 tw-p-2 tw-pb-4 tw-shadow"},[t("p",It,o(s(q)(d.createdAt).format("HH:mm, D MMMM, YYYY")),1),t("p",Rt,o(d.title),1)]))),128))])):(n(),w("div",Bt,[t("p",jt,o(s(l)("noInfoTitle")),1)]))])]),_:1})])]),_:1})}}}),Yt={class:"tw-flex tw-flex-col tw-justify-center"},Lt={class:"tw-mb-3 tw-flex tw-items-center tw-justify-between"},Ot={class:"tw-text-xl tw-font-semibold"},At={key:0},Ht={class:"tw-max-w-60 tw-truncate"},Pt={key:1},Ft={class:"tw-text-lg"},zt=S({__name:"MaterialWidget",props:{materials:{default(){return[]},type:Object},total:{default:0,type:Number}},setup(c){const{t:l}=I(),u=B(),g=U(),i=m=>{g.push({name:m,query:{id:u.query.id}})};return(m,_)=>(n(),N(L,{class:"tw-relative tw-h-full"},{default:a(()=>[t("div",Yt,[t("div",null,[t("div",Lt,[t("p",Ot,o(s(l)("client.homeTasks")),1),t("div",null,[e(h,{onClick:_[0]||(_[0]=f=>i("Learning materials")),color:"primary",variant:"tonal"},{default:a(()=>[$(o(s(l)("client.showMore")),1)]),_:1})])]),c.total?(n(),w("div",At,[(n(!0),w(M,null,Y(c.materials,f=>(n(),w("div",{key:f.material.name,class:"tw-mb-1 tw-flex tw-justify-between tw-text-base"},[t("p",Ht,o(f.material.name),1),t("p",null,o(s(q)(f.createdAt).format("HH:mm, D MMMM, YYYY")),1)]))),128))])):(n(),w("div",Pt,[t("p",Ft,o(s(l)("noInfoTitle")),1)]))])])]),_:1}))}}),Wt={class:"tw-flex tw-flex-col tw-justify-center"},Et={class:"tw-mb-3 tw-flex tw-items-center tw-justify-between"},Kt={class:"tw-flex tw-items-center tw-justify-between"},Jt={class:"tw-mb-2 tw-text-xl tw-font-semibold"},Qt={key:0,class:"tw-mb-8 tw-pl-1"},Gt={class:"text-primary tw-font-semibold"},Xt={class:"tw-max-w-60"},Zt={key:1,class:"tw-mb-8 tw-pl-1"},te={class:"tw-text-lg"},ee={class:"text-primary tw-text-base"},se=S({__name:"RecordingWidget",props:{sessions:{default(){return[]},type:Object},total:{default:0,type:Number},showMore:{default:!1,type:Boolean},icon:{default:!1,type:Boolean}},setup(c){const{t:l}=I(),u=B(),g=U(),i=y(!1),m=y(),_=d=>{g.push({name:d,query:{id:u.query.id}})},f=async d=>{i.value=!0,m.value=d};return(d,p)=>{const V=C("VideoIcon"),T=C("ReportSearchIcon");return n(),w(M,null,[e(L,{class:"tw-relative tw-h-full"},{default:a(()=>[t("div",Wt,[t("div",null,[t("div",Et,[t("div",Kt,[c.icon?(n(),N(V,{key:0,class:"tw-mb-2 tw-mr-2",width:"32px",height:"32px"})):j("",!0),t("h4",Jt,o(s(l)("Recordings")),1)]),c.showMore?(n(),N(h,{key:0,onClick:p[0]||(p[0]=b=>_("Recording")),color:"primary",variant:"tonal"},{default:a(()=>[$(o(s(l)("client.showMore")),1)]),_:1})):j("",!0)]),c.total?(n(),w("div",Qt,[(n(!0),w(M,null,Y(c.sessions,b=>(n(),w("p",{key:b.id,class:"tw-mb-2 tw-flex tw-justify-between tw-items-center tw-text-base"},[t("span",null,[t("span",Gt,o(s(q)(b.startsAt).format("HH:mm DD MMMM")),1),$(" "+o(b.clientName),1)]),t("span",Xt,[e(h,{onClick:R=>f(b),class:"tw-mr-3",color:"info",variant:"tonal",size:"small",icon:""},{default:a(()=>[e(T,{class:"text-info",size:"20","stroke-width":"1.5"})]),_:2},1032,["onClick"])])]))),128))])):(n(),w("div",Zt,[t("p",te,o(s(l)("noInfoTitle")),1)]))]),c.showMore?j("",!0):(n(),N(s(rt),{key:0,to:{name:"Sessions"},class:"tw-absolute tw-bottom-6 tw-pl-1"},{default:a(()=>[t("p",ee,o(s(l)("dashboard.sessionLink")),1)]),_:1}))])]),_:1}),e(_t,{modelValue:i.value,"onUpdate:modelValue":p[1]||(p[1]=b=>i.value=b),form:m.value,"onUpdate:form":p[2]||(p[2]=b=>m.value=b)},null,8,["modelValue","form"])],64)}}}),le={class:"tw-flex tw-flex-col"},ae={class:"tw-mb-4 tw-text-xl tw-font-semibold"},oe={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-pt-6"},ie={class:"tw-mb-7 tw-mr-5 tw-w-full"},ne={class:"tw-text-xs tw-text-slate-500"},re={class:"tw-truncate tw-text-base"},ce={class:"tw-mb-7 tw-mr-5"},ue={class:"tw-text-xs tw-text-slate-500"},de={class:"tw-max-w-60 tw-truncate tw-text-base"},me={class:"tw-mb-7 tw-mr-5"},fe={class:"tw-text-xs tw-text-slate-500"},we={class:"tw-text-base"},_e={key:0,class:"tw-mb-7 tw-mr-5"},pe={class:"tw-mb-2 tw-pl-4 tw-text-xs tw-text-slate-500"},ve={class:"tw-mb-3.5 tw-flex"},ge=S({__name:"PersonalDetailsWidget",props:{clientDetails:{type:Object,required:!0},total:{default:0,type:Number}},setup(c){const{t:l}=I();return(u,g)=>{const i=C("perfect-scrollbar");return n(),N(L,{class:"tw-relative tw-h-full"},{default:a(()=>[t("div",le,[t("p",ae,o(s(l)("client.detailsTitle")),1),t("div",oe,[t("div",ie,[t("p",ne,o(s(l)("name")),1),t("p",re,o(c.clientDetails.firstName)+" "+o(c.clientDetails.lastName),1)]),t("div",ce,[t("p",ue,o(s(l)("email")),1),t("p",de,o(c.clientDetails.email??"-"),1)]),t("div",me,[t("p",fe,o(s(l)("client.lastSession")),1),t("p",we,o(s(q)(c.clientDetails.lastSession).format("HH:mm, D MMMM, YYYY")??"-"),1)])]),c.clientDetails.tags.total?(n(),w("div",_e,[t("p",pe,o(s(l)("client.tags")),1),e(i,null,{default:a(()=>[t("div",ve,[(n(!0),w(M,null,Y(c.clientDetails.tags.list,m=>(n(),N(h,{key:m.id,class:"tw-mr-2 !tw-min-w-14",variant:"tonal",color:"primary"},{default:a(()=>[$(o(m.name),1)]),_:2},1024))),128))])]),_:1})])):j("",!0)])]),_:1})}}}),ye={class:"tw-flex tw-justify-between tw-px-6 tw-py-3"},Re=S({__name:"Details",setup(c){const{t:l}=I(),u=B(),g=U(),i=vt(),m=E(),_=yt(),f=gt(),d=bt(),p=pt(),V=y(!0);y(!1);const T=()=>{g.push({name:"Clients List"})};return Promise.all([m.getTags(),i.getNotes({clientId:u.query.id}),_.getBilling({clientId:u.query.id,limit:3}),f.getSessions({clientId:u.query.id,from:q().startOf("day").valueOf(),to:q().endOf("day").valueOf(),limit:3,status:["BOOKED"]}),d.getAssigmentMaterials({clientId:u.query.id,from:0,to:3}),p.getRecordsById(Number(u.query.id),{id:u.query.id,limit:3})]).then(()=>{V.value=!1}),(b,R)=>(n(),w(M,null,[e(wt,{title:"sidebar.clientDetails"}),e(dt,{isUpdate:V.value},{default:a(()=>[e(z,null,{default:a(()=>[e(D,null,{default:a(()=>[e(W,{elevation:"10"},{default:a(()=>[t("div",ye,[e(h,{onClick:T,color:"primary"},{default:a(()=>[$(o(s(l)("goBack")),1)]),_:1}),t("div",null,[e(Nt)])])]),_:1})]),_:1})]),_:1}),e(z,null,{default:a(()=>[e(D,{cols:"12",md:"6"},{default:a(()=>[e(se,{sessions:s(p).list,total:s(p).total,"show-more":""},null,8,["sessions","total"])]),_:1}),e(D,{cols:"12",md:"6"},{default:a(()=>[e(mt,{payments:s(_).list,total:s(_).total,"show-more":""},null,8,["payments","total"])]),_:1}),e(D,{cols:"12",md:"6"},{default:a(()=>[e(ge,{"client-details":s(m).clientDetails},null,8,["client-details"])]),_:1}),e(D,{cols:"12",md:"6"},{default:a(()=>[e(Ut,{notes:s(i).list,total:s(i).total},null,8,["notes","total"])]),_:1}),e(D,{cols:"12",md:"6"},{default:a(()=>[e(ft,{sessions:s(f).list,total:s(f).total,"show-more":""},null,8,["sessions","total"])]),_:1}),e(D,{cols:"12",md:"6"},{default:a(()=>[e(zt,{materials:s(d).assigmentList,total:s(d).assigmentTotal},null,8,["materials","total"])]),_:1})]),_:1})]),_:1},8,["isUpdate"])],64))}});export{Re as default};
