import{d as st,u as ot,h as at,i as nt,k as _,n as B,H as lt,o as p,c as rt,e as l,w as o,a as A,b as e,p as y,m as k,aI as w,_ as it,f as x,t as u,Z as ut,V as S,q as D,s as M,F as dt,r as N}from"./index-rKzDa4TW.js";import{h as d}from"./moment-zH0z38ay.js";import"./lodash-CyvJ_RrL.js";import{_ as ct}from"./AddEventModal.vue_vue_type_style_index_0_lang-BqGhG1bK.js";import{_ as ft}from"./BaseCard.vue_vue_type_script_setup_true_lang-CXnM25sU.js";import{_ as pt}from"./BaseTable.vue_vue_type_style_index_0_lang-BdcfvIXs.js";import{_ as vt}from"./BaseLoader.vue_vue_type_script_setup_true_lang-DEUrq8Kn.js";import{u as mt,_ as gt}from"./Sessions-CL54E7Ic.js";import{_ as _t}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-C_OQyfJV.js";import{_ as yt}from"./SessionUserModals.vue_vue_type_script_setup_true_lang-BcBCTGGF.js";import{u as kt}from"./Sessions-dyfPvYgZ.js";import{U as wt}from"./user-1-B0DTw7e0.js";import"./maska-Cp-LWreF.js";import"./Client-V112gc0S.js";import"./Rules-DZKrv_I-.js";import"./DeleteModal.vue_vue_type_script_setup_true_lang-1BeL1TZf.js";const xt=["src"],Ct={class:"tw-max-w-60 tw-truncate"},It=10,Et=st({__name:"Sessions",setup($t){const{t:i}=ot(),h=at(),C=kt(),I=nt(),{form:c,loading:bt,loadingBook:H,dialogEvent:v,dialogDelete:m,selectColors:g,loadingDelete:O,typeName:P,colorType:R,deleteItem:z,bookSession:F,confirmEdit:E,confirmDelete:j,isDeleteSession:T,isAbleToJoinSession:q,changeInvalidSession:L}=mt(),J="â‚½",V=_(1),$=_(!0),n=_(),b=_([]),U=B(()=>g.value.filter(a=>a.isActive).map(a=>a.id)),Z=B(()=>[{text:"#",value:"avatar",sortable:!0},{text:i("sessions.client"),value:"firstName",sortable:!0},{text:i("sessions.time"),value:"startsAt",sortable:!0},{text:"Price",value:"costInCents",sortable:!0},{text:i("sessions.type"),value:"status",sortable:!0},{text:i("sessions.actions"),value:"actions",sortable:!0,width:200}]),G=async a=>{await C.getSessions({from:d().add(-1,"days").valueOf(),to:d().add(7,"days").valueOf(),status:U.value,...a}),$.value=!1},K=async a=>{await a({status:U.value,from:d().add(-1,"days").valueOf(),to:d().add(7,"days").valueOf()}),$.value=!1},Q=a=>{v.value=!0,c.value={...a,occurrenceStartsAt:a.startsAt}},W=(a,s)=>{h.push({name:"video chat",query:{id:a,start:d(s).valueOf()}})},X=a=>{c.value=a,m.value=!0};return lt(U,()=>{n.value&&n.value.filter()}),I.user.type==="Therapist"&&(b.value=[{label:"Name",key:"name",value:null}]),(a,s)=>{const Y=N("LoginIcon"),tt=N("PencilIcon"),et=N("TrashIcon");return p(),rt(dt,null,[l(_t,{title:"sidebar.sessions"}),l(vt,{isUpdate:$.value},{default:o(()=>[l(ft,null,{default:o(()=>[A("div",{class:it([e(I).user.type==="Therapist"?"tw-justify-between":"tw-justify-end","tw-mb-3 tw-block md:tw-flex"])},[e(I).user.type==="Therapist"?(p(),y(ct,{key:0,onUpdate:s[0]||(s[0]=t=>n.value?n.value.filter():null),title:e(i)("sessions.newSession")},null,8,["title"])):k("",!0),l(gt,{selectColors:e(g),"onUpdate:selectColors":s[1]||(s[1]=t=>w(g)?g.value=t:null)},null,8,["selectColors"])],2),l(pt,{onUpdate:G,onCreated:K,page:V.value,"onUpdate:page":s[2]||(s[2]=t=>V.value=t),filters:b.value,"onUpdate:filters":s[3]||(s[3]=t=>b.value=t),total:e(C).total,items:e(C).list,perPage:It,headers:Z.value,ref_key:"table",ref:n},{"item-startsAt":o(t=>[x(u(e(d)(t.startsAt).format("HH:mm"))+" - "+u(e(d)(t.startsAt).add(t.durationInMinutes,"minutes").format("HH:mm"))+u(e(d)(t.startsAt).format(" D MMMM")),1)]),"item-service":o(t=>[x(u(t.service.title),1)]),"item-costInCents":o(t=>[x(u(t.costInCents/100)+" "+u(e(J)),1)]),"item-status":o(t=>[l(ut,{color:e(R)(t.status,t.startsAt,t.durationInMinutes)},{default:o(()=>[x(u(e(P)(t.status,t.startsAt,t.durationInMinutes)),1)]),_:2},1032,["color"])]),"item-avatar":o(t=>{var r;return[A("img",{src:((r=t==null?void 0:t.opponent)==null?void 0:r.avatar)||e(wt),alt:"avatar",width:"40",height:"40",class:"tw-rounded-full"},null,8,xt)]}),"item-firstName":o(t=>{var r,f;return[A("p",Ct,u(t.opponent?`${(r=t==null?void 0:t.opponent)==null?void 0:r.firstName} ${(f=t==null?void 0:t.opponent)==null?void 0:f.lastName}`:e(i)("sessions.freeSpace")),1)]}),"item-actions":o(t=>[e(q)(t.startsAt,t.durationInMinutes,t.status)?(p(),y(M,{key:0,text:e(i)("sessions.enterTheRoom")},{activator:o(({props:r})=>[l(S,D({onClick:f=>W(t.id,t.startsAt)},r,{class:"tw-mr-3",color:"primary",variant:"tonal",icon:""}),{default:o(()=>[l(Y,{class:"text-primary",size:"20","stroke-width":"1.5"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):k("",!0),e(T)(t.startsAt,t.durationInMinutes)?(p(),y(M,{key:1,text:e(i)("edit")},{activator:o(({props:r})=>[l(S,D({onClick:f=>Q(t)},r,{color:"info",class:"tw-mr-3",variant:"tonal",icon:""}),{default:o(()=>[l(tt,{class:"text-info","stroke-width":"1.5",size:"20"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):k("",!0),e(T)(t.startsAt,t.durationInMinutes)?(p(),y(M,{key:2,text:e(i)("sessions.cancelSession")},{activator:o(({props:r})=>[l(S,D({onClick:f=>X(t)},r,{color:"error",variant:"tonal",icon:""}),{default:o(()=>[l(et,{size:"20",class:"text-error","stroke-width":"1.5"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):k("",!0)]),_:1},8,["page","filters","total","items","headers"])]),_:1})]),_:1},8,["isUpdate"]),l(yt,{onBook:s[4]||(s[4]=t=>e(F)(n.value?n.value.filter:null)),onUpdate:s[5]||(s[5]=t=>e(E)(n.value?n.value.filter:null)),onDelete:e(z),onDeleteConfirm:s[6]||(s[6]=t=>e(j)(n.value?n.value.filter:null)),onInvalid:s[7]||(s[7]=t=>e(L)(n.value?n.value.filter:null)),form:e(c),"onUpdate:form":s[8]||(s[8]=t=>w(c)?c.value=t:null),dialog:e(v),"onUpdate:dialog":s[9]||(s[9]=t=>w(v)?v.value=t:null),"dialog-delete":e(m),"onUpdate:dialogDelete":s[10]||(s[10]=t=>w(m)?m.value=t:null),loading:e(H),"loading-delete":e(O)},null,8,["onDelete","form","dialog","dialog-delete","loading","loading-delete"])],64)}}});export{Et as default};
