import{_ as le}from"./lodash-CyvJ_RrL.js";import{_ as oe}from"./BaseLoader.vue_vue_type_script_setup_true_lang-DEUrq8Kn.js";import{c as C,_ as se,a as ie}from"./AddNoteModal.vue_vue_type_style_index_0_lang-CeK8vWeX.js";import{d as Q,u as G,i as J,ao as $,k as p,n as K,H as I,o as m,c as k,a as v,t as h,b as i,e as s,an as ne,p as b,ae as re,m as T,F as S,B as q,w as u,V as j,at as ue,_ as E,s as de,f as P,I as ce,D,a9 as fe,r as z,af as pe,z as me}from"./index-rKzDa4TW.js";import{_ as ve}from"./DeleteModal.vue_vue_type_script_setup_true_lang-1BeL1TZf.js";import{u as O}from"./Notes-CchFvEs0.js";import{u as R}from"./Client-V112gc0S.js";import{_ as we}from"./AppBaseCard.vue_vue_type_style_index_0_lang-Dpey-dUQ.js";import{_ as Ne}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-C_OQyfJV.js";import"./Rules-DZKrv_I-.js";const ge={class:"pa-6"},_e={class:"text-h6 tw-mb-2 tw-text-center"},Ue={class:"tw-mb-3"},ye={class:"tw-mb-3 tw-flex tw-items-center tw-justify-between tw-gap-3 tw-px-2"},he={key:0,class:"note-pagination"},xe={class:"tw-text-sm"},Ve={class:"d-flex align-center mt-3"},Ce={class:"tw-flex tw-font-semibold"},B=10,H=Q({__name:"NoteSidebar",props:{edit:{},editModifiers:{},form:{required:!0},formModifiers:{},updateNote:{},updateNoteModifiers:{},isUpdate:{},isUpdateModifiers:{}},emits:["update:edit","update:form","update:updateNote","update:isUpdate"],setup(x){const{t:n}=G(),d=O(),U=J(),A=R(),c=$(x,"edit"),y=$(x,"form"),g=$(x,"updateNote"),_=$(x,"isUpdate"),l=p(1),w=p(""),N=p(null),f=p(!1),a=p(!1),e=p(C.map(t=>t.id)),W=K(()=>A.clientList.map(t=>({title:`${t.firstName} ${t.lastName}`,props:{value:t.id}}))),F=t=>{const r=C.find(V=>V.id===t);return r?r.color:"primary"},X=t=>{if(!e.value.includes(t))e.value.push(t);else{const r=e.value.filter(V=>V!==t);e.value=r}},Y=t=>{y.value=t,g.value=!0,c.value=!1,setTimeout(()=>{c.value=!0,g.value=!1},0)},Z=t=>{y.value=t,f.value=!0},ee=async()=>{a.value=!0;try{await d.deleteNotes(y.value.id),U.createNotification({title:n("notification.noteDelete"),color:"success"}),c.value=!1,f.value=!1}catch{U.createNotification({title:n("notification.errorNotification"),color:"error"})}a.value=!1},M=le.debounce(async()=>{c.value=!1;const t={};w.value&&(t.name=w.value),N.value&&(t.clientId=N.value),e.value.length&&e.value.length!==C.length&&(t.color=e.value),l.value=1,await d.getNotes(t),_.value=!1},700);return I(l,async()=>{c.value=!1;let t={};w.value&&(t.name=w.value),N.value&&(t.clientId=N.value),e.value.length&&e.value.length!==C.length&&(t.color=e.value),l.value>1&&(t={...t,offset:B*(l.value-1)}),await d.getNotes(t),_.value=!1},{immediate:!0}),I(w,M),I(()=>e.value.length,M),U.user.type==="Therapist"&&I(N,M),(t,r)=>{const V=z("CheckIcon"),te=z("TrashIcon"),ae=z("NotesIcon");return m(),k("div",ge,[v("h4",_e,h(i(n)("notes.sidebarTitle")),1),v("div",Ue,[s(ne,{modelValue:w.value,"onUpdate:modelValue":r[0]||(r[0]=o=>w.value=o),label:i(n)("notes.filterNotes"),class:"tw-mb-2",density:"compact",variant:"outlined","append-inner-icon":"mdi-magnify","hide-details":""},null,8,["modelValue","label"]),i(U).user.type==="Therapist"?(m(),b(re,{key:0,modelValue:N.value,"onUpdate:modelValue":r[1]||(r[1]=o=>N.value=o),items:W.value,label:i(n)("notes.filterClient"),class:"tw-mb-2 tw-w-full",variant:"outlined",density:"compact",clearable:"","hide-details":""},null,8,["modelValue","items","label"])):T("",!0),v("div",ye,[(m(!0),k(S,null,q(i(C),o=>(m(),b(j,{onClick:L=>X(o.id),key:o.id,color:o.color,size:"x-small",icon:""},{default:u(()=>[e.value.includes(o.id)?(m(),b(V,{key:0,width:"16"})):T("",!0)]),_:2},1032,["onClick","color"]))),128))])]),i(d).total>B?(m(),k("div",he,[s(ue,{modelValue:l.value,"onUpdate:modelValue":r[2]||(r[2]=o=>l.value=o),length:Math.ceil(i(d).total/B),"total-visible":1,class:"tw-w-full",color:"primary",rounded:"circle",size:"small"},null,8,["modelValue","length"]),v("p",xe,h(i(n)("notes.total"))+" "+h(i(d).total),1)])):T("",!0),(m(!0),k(S,null,q(i(d).list,o=>(m(),b(D,{onClick:L=>Y(o),class:E(`note-sheet pa-6 pb-4 rounded-md cursor-pointer mb-4  bg-light${F(o.color)}`),key:o.id},{default:u(()=>[v("div",null,[v("h6",{class:E(`text-h6 text-truncate text-${F(o.color)}`)},h(o.title),3),v("div",Ve,[s(j,{onClick:ce(L=>Z(o),["stop"]),variant:"text",class:"ml-auto",size:"x-small",icon:""},{default:u(()=>[s(de,{activator:"parent",location:"top"},{default:u(()=>[P(h(i(n)("notes.deleteNote")),1)]),_:1}),s(te,{size:"18"})]),_:2},1032,["onClick"])])])]),_:2},1032,["onClick","class"]))),128)),i(d).list.length?T("",!0):(m(),b(D,{key:1},{default:u(()=>[s(fe,{class:"bg-lightsecondary"},{default:u(()=>[v("p",Ce,[s(ae,{class:"tw-mr-2"}),P(" "+h(i(n)("notes.sidebarAlert")),1)])]),_:1})]),_:1})),s(ve,{onDelete:ee,modelValue:f.value,"onUpdate:modelValue":r[3]||(r[3]=o=>f.value=o),loading:a.value,title:i(n)("notes.deleteNote"),question:i(n)("notes.deleteQuestion")},null,8,["modelValue","loading","title","question"])])}}}),be={class:"!tw-sticky !tw-top-32"},ke={class:"text-h6"},qe=Q({__name:"Notes",setup(x){const{t:n}=G(),d=O(),U=J(),A=R(),c=p(!1),y=p(!1),g=p(!0),_=p(!1),l=p({id:0,color:0,text:"",title:"",createdAt:"",entityType:"",entityId:null}),w=K(()=>A.clientList.map(f=>({title:`${f.firstName} ${f.lastName}`,props:{value:f.id}}))),N=async()=>{y.value=!0;try{const f={color:l.value.color,createdAt:l.value.createdAt,title:l.value.title,text:l.value.text,id:l.value.id};l.value.entityId?await d.changeNotes(l.value):await d.changeNotes(f),U.createNotification({title:n("notification.noteChange"),color:"success"})}catch{U.createNotification({title:n("notification.errorNotification"),color:"error"})}y.value=!1};return(f,a)=>(m(),k(S,null,[s(Ne,{title:"sidebar.notes"}),s(oe,{isUpdate:g.value},{default:u(()=>[s(pe,{elevation:"20",class:"!tw-overflow-clip"},{default:u(()=>[s(we,null,{leftpart:u(()=>[s(H,{form:l.value,"onUpdate:form":a[0]||(a[0]=e=>l.value=e),updateNote:_.value,"onUpdate:updateNote":a[1]||(a[1]=e=>_.value=e),edit:c.value,"onUpdate:edit":a[2]||(a[2]=e=>c.value=e),isUpdate:g.value,"onUpdate:isUpdate":a[3]||(a[3]=e=>g.value=e)},null,8,["form","updateNote","edit","isUpdate"])]),rightpart:u(()=>[v("div",be,[s(D,{class:"!tw-flex tw-items-center tw-justify-between tw-p-3 md:tw-px-6"},{default:u(()=>[v("h4",ke,h(i(n)("notes.editNotes")),1),s(se)]),_:1}),s(me),s(D,{class:"tw-px-3 tw-py-4 md:tw-px-6"},{default:u(()=>[s(ie,{onUpdate:N,form:l.value,"onUpdate:form":a[4]||(a[4]=e=>l.value=e),updateNote:_.value,edit:c.value,loading:y.value,clients:w.value,"edit-variant":""},null,8,["form","updateNote","edit","loading","clients"])]),_:1})])]),mobileLeftContent:u(()=>[s(H,{form:l.value,"onUpdate:form":a[5]||(a[5]=e=>l.value=e),updateNote:_.value,"onUpdate:updateNote":a[6]||(a[6]=e=>_.value=e),edit:c.value,"onUpdate:edit":a[7]||(a[7]=e=>c.value=e),isUpdate:g.value,"onUpdate:isUpdate":a[8]||(a[8]=e=>g.value=e)},null,8,["form","updateNote","edit","isUpdate"])]),_:1})]),_:1})]),_:1},8,["isUpdate"])],64))}});export{qe as default};
