import{_ as Z}from"./AddEventModal.vue_vue_type_style_index_0_lang-D9lYkCIH.js";import{u as L}from"./Sessions-BbabeFQp.js";import{d as U,u as O,i as N,k as _,n as g,o as h,c as k,e as r,w as f,f as M,t as w,b as d,_ as ee,V as b,af as S,aF as j,a as u,ak as B,F as te,B as ae,al as W,J as z,am as Y,r as I,az as se,H as le,aw as R,s as re,q as oe,ai as ne,ao as ue,aK as v,p as T,m as A}from"./index-BhGVanJs.js";import{j as de}from"./maska-Cp-LWreF.js";import{_ as D}from"./lodash-CVc3FTaT.js";class Ee{constructor(a={},t,l,i,c={from:null,to:null}){this.currentDate={year:a.year,month:a.month,date:a.date,firstDayOfWeek:a.firstDayOfWeek},this.textFormat=l,this.formatOptions=i,this.currentYear=new Date().getFullYear(),this.lang=t,this.disabledRange=c,this.years=[...Array(11)].map((y,p)=>this.currentDate.year+p),this.months=this.getMonths(),this.days=this.getDays(),this.firstDayOfMonth=this.getFirstDayOfMonth(),this.dates=this.getDates(),this.daysOfMonth=this.showDates(),this.weeksOfMonth=this.getWeekOfMonth()}getDays(){const a=[];let t,l;for(let i=1;i<=7;i++)l=new Date(this.currentDate.year,"00",i).toLocaleString(this.lang,{weekday:this.textFormat}),t=parseInt(new Date(this.currentDate.year,"00",i).getDay()),this.currentDate.firstDayOfWeek==="monday"&&(t=(t-1+7)%7),a.push({name:l,dayNumber:t});return this.sortDays(a),a}getMonths(){const a=[];for(let t=0;t<12;t++){const l=new Date(this.currentDate.year,t).toLocaleString(this.lang,{month:this.textFormat});a.push({index:t,name:l})}return a}getDates(){const a=[],t=this.currentDate.year%4===0?367:366;for(let l=1;l<t;l++){const i=new Date(this.currentDate.year,"00",l);a.push(i)}return a}showDates(){const a=this.dates.findIndex(m=>new Date(m).getMonth()===this.currentDate.month);let t=this.dates.filter(m=>new Date(m).getMonth()===this.currentDate.month),l=[],i=this.firstDayOfMonth;const c=new Date(this.currentDate.year,"00",1).getDate();if(this.currentDate.month===0)for(;i>0;){const m=new Date(this.currentDate.year,"00",c-i);l.push({date:m,isDayInMouth:!1}),i-=1}else for(;i>0&&a-i>0;){const m=this.dates[a-i];l.push({date:m,isDayInMouth:!1}),i-=1}t=t.map(m=>({date:m,isDayInMouth:!0})),l=l.concat(t);let y=0,p;for(;l.length%7;){p=a+t.length+y;const m=p<365?this.dates[a+t.length+y]:new Date(this.currentDate.year+1,"00",y+1);l.push({date:m,isDayInMouth:!1}),y+=1}return l=l.map(m=>({mouth:new Date(m.date).getMonth(),day:new Date(m.date).getDate(),date:new Date(m.date).toLocaleDateString(this.lang,{...this.formatOptions}),fullDate:new Date(m.date),isDayInMouth:m.isDayInMouth,isUsable:(this.disabledRange.from?this.dateCompare(this.disabledRange.from,m.date,"small"):!0)&&(this.disabledRange.to?this.dateCompare(this.disabledRange.to,m.date,"big"):!0)})),l}dateCompare(a,t,l){switch(a=new Date(a),t=new Date(t),a.setHours(0,0,0,0),t.setHours(0,0,0,0),l){case"small":return a.getTime()>=t.getTime();case"big":return t.getTime()>=a.getTime()}}getFirstDayOfMonth(){let a=new Date(this.currentDate.year,this.currentDate.month,"01").getDay();return this.currentDate.firstDayOfWeek.toLowerCase()==="monday"&&(a=(a-1+7)%7),parseInt(a)}sortDays(a){return a.sort((t,l)=>t.dayNumber-l.dayNumber)}getWeekOfMonth(){let a=[];const t=Math.round(this.daysOfMonth.length/7);for(let l=0;l<t;l++){const i=this.dates.findIndex(y=>new Date(y).getMonth()===this.currentDate.month),c=Math.floor(i/7)+l+1;a.push({index:c,name:c})}return a}}const ie={class:"title text-white"},me={key:0},we={key:1},ce={class:"tw-mb-2 tw-text-lg tw-font-semibold"},ye={class:"tw-flex tw-items-center"},fe={class:"tw-mr-2"},ve=U({__name:"IntegrationModal",setup($){const{t:a}=O(),t=L(),l=N(),i=_(!0),c=_(!1),y=_(!1),p=g(()=>"https://api.mentalcrm.ru"),m=async C=>{c.value=!0;try{await t.deleteCronofyCalendar(C),l.createNotification({title:a("notification.calendarMessageDelete"),color:"success"})}catch{l.createNotification({title:a("notification.errorNotification"),color:"error"})}c.value=!1};return t.getCronofyCalendars().then(()=>{i.value=!1}),(C,H)=>{const V=I("TrashIcon");return h(),k("div",null,[r(b,{onClick:H[0]||(H[0]=e=>y.value=!0),class:ee([{"tw-mb-2 ":d(l).user.type==="Therapist","md:tw-mr-3":d(l).user.type==="Therapist"},"tw-mr-0 !tw-min-w-full md:tw-mb-0 md:!tw-min-w-fit"]),loading:i.value,color:"primary"},{default:f(()=>[M(w(d(a)("calendar.integration")),1)]),_:1},8,["class","loading"]),r(Y,{modelValue:y.value,"onUpdate:modelValue":H[2]||(H[2]=e=>y.value=e),width:"700"},{default:f(()=>[r(S,null,{default:f(()=>[r(j,{class:"pa-4 bg-primary"},{default:f(()=>[u("p",ie,w(d(a)("calendar.integration")),1)]),_:1}),r(B,{class:"tw-mb-5"},{default:f(()=>[d(t).calendarsTotal?(h(),k("div",we,[u("p",ce,w(d(a)("calendar.yourAddedCalendars")),1),(h(!0),k(te,null,ae(d(t).calendars,e=>(h(),k("div",{key:e.profile_id,class:"tw-mb-2 tw-flex tw-items-center tw-justify-between"},[u("p",null,w(e.profile_name),1),u("div",ye,[u("p",fe,w(e.provider_name.charAt(0).toUpperCase()+e.provider_name.slice(1)),1),r(b,{onClick:F=>m(e.profile_id),loading:c.value,variant:"tonal",class:"tw-mr-3",color:"error",size:"small",icon:""},{default:f(()=>[r(V,{class:"text-error",size:"20","stroke-width":"1.5"})]),_:2},1032,["onClick","loading"])])]))),128))])):(h(),k("p",me,w(d(a)("calendar.noCalendars")),1))]),_:1}),r(W,null,{default:f(()=>[r(z),r(b,{onClick:H[1]||(H[1]=e=>y.value=!1),class:"tw-mr-2",color:"error"},{default:f(()=>[M(w(d(a)("close")),1)]),_:1}),r(b,{disabled:!1,href:`${p.value}/api/cronofy/redirect`,color:"primary",variant:"flat"},{default:f(()=>[M(w(d(a)("calendar.addCalendar")),1)]),_:1},8,["href"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),pe={class:"title text-white"},he={class:"tw-mb-1 tw-flex tw-items-center tw-justify-between"},ge={class:"tw-text-sm"},He={class:"tw-mb-2 tw-flex tw-items-center"},De={class:"tw-w-full tw-max-w-48"},_e={class:"tw-mb-2 tw-flex tw-items-center"},be={class:"tw-w-full tw-max-w-48"},Ve={class:"tw-mb-2 tw-flex tw-items-center"},xe={class:"tw-w-full tw-max-w-48"},ke={class:"tw-mb-2 tw-flex tw-items-center"},Ce={class:"tw-w-full tw-max-w-48"},Me={class:"tw-mb-2 tw-flex tw-items-center"},$e={class:"tw-w-full tw-max-w-48"},Ie={class:"tw-mb-2 tw-flex tw-items-center"},Ue={class:"tw-w-full tw-max-w-48"},Oe={class:"tw-mb-2 tw-flex tw-items-center"},Te={class:"tw-w-full tw-max-w-48"},Ne=U({__name:"AvailabilityModal",emits:["update"],setup($,{emit:a}){const{t}=O(),l=N(),i=L(),c=a,y="â‚½",p=se({mask:`####### ${y}`,reversed:!0,eager:!0}),m=_(""),C=_(!1),H=_(!1),V=_(!1),e=_({priceInCents:0,currency:"EUR",monday:{startHour:0,endHour:0},tuesday:{startHour:0,endHour:0},wednesday:{startHour:0,endHour:0},thursday:{startHour:0,endHour:0},friday:{startHour:0,endHour:0},saturday:{startHour:0,endHour:0},sunday:{startHour:0,endHour:0}}),F=g(()=>D.range(24).filter(s=>s>=e.value.monday.startHour).map(s=>({title:`${s}:00`,props:{value:s}}))),E=g(()=>D.range(24).filter(s=>s>=e.value.tuesday.startHour).map(s=>({title:`${s}:00`,props:{value:s}}))),P=g(()=>D.range(24).filter(s=>s>=e.value.wednesday.startHour).map(s=>({title:`${s}:00`,props:{value:s}}))),Q=g(()=>D.range(24).filter(s=>s>=e.value.thursday.startHour).map(s=>({title:`${s}:00`,props:{value:s}}))),q=g(()=>D.range(24).filter(s=>s>=e.value.friday.startHour).map(s=>({title:`${s}:00`,props:{value:s}}))),J=g(()=>D.range(24).filter(s=>s>=e.value.saturday.startHour).map(s=>({title:`${s}:00`,props:{value:s}}))),K=g(()=>D.range(24).filter(s=>s>=e.value.sunday.startHour).map(s=>({title:`${s}:00`,props:{value:s}}))),x=g(()=>D.range(24).map(s=>({title:`${s}:00`,props:{value:s}})));le(m,s=>{e.value.priceInCents=Number(s.replace(` ${y}`,""))*100}),R(()=>{i.availability&&(e.value=i.availability)}),R(()=>{e.value.monday.startHour>e.value.monday.endHour&&(e.value.monday.endHour=e.value.monday.startHour),e.value.tuesday.startHour>e.value.tuesday.endHour&&(e.value.tuesday.endHour=e.value.tuesday.startHour),e.value.wednesday.startHour>e.value.wednesday.endHour&&(e.value.wednesday.endHour=e.value.wednesday.startHour),e.value.thursday.startHour>e.value.thursday.endHour&&(e.value.thursday.endHour=e.value.thursday.startHour),e.value.friday.startHour>e.value.friday.endHour&&(e.value.friday.endHour=e.value.friday.startHour),e.value.saturday.startHour>e.value.saturday.endHour&&(e.value.saturday.endHour=e.value.saturday.startHour),e.value.sunday.startHour>e.value.sunday.endHour&&(e.value.sunday.endHour=e.value.sunday.startHour)});const G=async()=>{C.value=!0;try{for(const s of Object.keys(e.value))["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].includes(s)&&e.value[s].startHour===e.value[s].endHour&&(e.value[s].startHour=0,e.value[s].endHour=0);await i.changeAvailability(e.value),await c("update"),V.value=!1,l.createNotification({title:t("notification.sessionCreate"),color:"success"})}catch{l.createNotification({title:t("notification.errorNotification"),color:"error"})}C.value=!1};return i.getAvailability(),(s,o)=>{const X=I("QuestionMarkIcon");return h(),k("div",null,[r(b,{onClick:o[0]||(o[0]=n=>V.value=!0),loading:H.value,disabled:"",color:"primary",class:"!tw-min-w-full md:!tw-min-w-fit"},{default:f(()=>[M(w(d(t)("profile.availability")),1)]),_:1},8,["loading"]),r(Y,{modelValue:V.value,"onUpdate:modelValue":o[17]||(o[17]=n=>V.value=n),width:"700"},{default:f(()=>[r(S,null,{default:f(()=>[r(j,{class:"pa-4 bg-primary"},{default:f(()=>[u("p",pe,w(d(t)("profile.availability")),1)]),_:1}),r(B,null,{default:f(()=>[u("div",null,[u("div",he,[u("p",ge,w(d(t)("sessions.price")),1),r(re,{text:d(t)("sessions.priceModalInfo")},{activator:f(({props:n})=>[r(b,oe(n,{class:"tw-scale-75",size:"x-small",color:"primary",variant:"tonal",icon:""}),{default:f(()=>[r(X)]),_:2},1040)]),_:1},8,["text"])]),ne(r(ue,{modelValue:m.value,"onUpdate:modelValue":o[1]||(o[1]=n=>m.value=n),disabled:!d(l).user.stripeAttached,class:"tw-mb-3",variant:"outlined"},null,8,["modelValue","disabled"]),[[d(de),void 0,p]])]),u("div",He,[u("p",De,w(d(t)("calendar.weekDays[0].full")),1),r(v,{modelValue:e.value.monday.startHour,"onUpdate:modelValue":o[2]||(o[2]=n=>e.value.monday.startHour=n),items:x.value,class:"tw-mr-3","hide-details":""},null,8,["modelValue","items"]),r(v,{modelValue:e.value.monday.endHour,"onUpdate:modelValue":o[3]||(o[3]=n=>e.value.monday.endHour=n),items:F.value,"hide-details":""},null,8,["modelValue","items"])]),u("div",_e,[u("p",be,w(d(t)("calendar.weekDays[1].full")),1),r(v,{modelValue:e.value.tuesday.startHour,"onUpdate:modelValue":o[4]||(o[4]=n=>e.value.tuesday.startHour=n),items:x.value,class:"tw-mr-3","hide-details":""},null,8,["modelValue","items"]),r(v,{modelValue:e.value.tuesday.endHour,"onUpdate:modelValue":o[5]||(o[5]=n=>e.value.tuesday.endHour=n),items:E.value,"hide-details":""},null,8,["modelValue","items"])]),u("div",Ve,[u("p",xe,w(d(t)("calendar.weekDays[2].full")),1),r(v,{modelValue:e.value.wednesday.startHour,"onUpdate:modelValue":o[6]||(o[6]=n=>e.value.wednesday.startHour=n),items:x.value,class:"tw-mr-3","hide-details":""},null,8,["modelValue","items"]),r(v,{modelValue:e.value.wednesday.endHour,"onUpdate:modelValue":o[7]||(o[7]=n=>e.value.wednesday.endHour=n),items:P.value,"hide-details":""},null,8,["modelValue","items"])]),u("div",ke,[u("p",Ce,w(d(t)("calendar.weekDays[3].full")),1),r(v,{modelValue:e.value.thursday.startHour,"onUpdate:modelValue":o[8]||(o[8]=n=>e.value.thursday.startHour=n),items:x.value,class:"tw-mr-3","hide-details":""},null,8,["modelValue","items"]),r(v,{modelValue:e.value.thursday.endHour,"onUpdate:modelValue":o[9]||(o[9]=n=>e.value.thursday.endHour=n),items:Q.value,"hide-details":""},null,8,["modelValue","items"])]),u("div",Me,[u("p",$e,w(d(t)("calendar.weekDays[4].full")),1),r(v,{modelValue:e.value.friday.startHour,"onUpdate:modelValue":o[10]||(o[10]=n=>e.value.friday.startHour=n),items:x.value,class:"tw-mr-3","hide-details":""},null,8,["modelValue","items"]),r(v,{modelValue:e.value.friday.endHour,"onUpdate:modelValue":o[11]||(o[11]=n=>e.value.friday.endHour=n),items:q.value,"hide-details":""},null,8,["modelValue","items"])]),u("div",Ie,[u("p",Ue,w(d(t)("calendar.weekDays[5].full")),1),r(v,{modelValue:e.value.saturday.startHour,"onUpdate:modelValue":o[12]||(o[12]=n=>e.value.saturday.startHour=n),items:x.value,class:"tw-mr-3","hide-details":""},null,8,["modelValue","items"]),r(v,{modelValue:e.value.saturday.endHour,"onUpdate:modelValue":o[13]||(o[13]=n=>e.value.saturday.endHour=n),items:J.value,"hide-details":""},null,8,["modelValue","items"])]),u("div",Oe,[u("p",Te,w(d(t)("calendar.weekDays[6].full")),1),r(v,{modelValue:e.value.sunday.startHour,"onUpdate:modelValue":o[14]||(o[14]=n=>e.value.sunday.startHour=n),items:x.value,class:"tw-mr-3","hide-details":""},null,8,["modelValue","items"]),r(v,{modelValue:e.value.sunday.endHour,"onUpdate:modelValue":o[15]||(o[15]=n=>e.value.sunday.endHour=n),items:K.value,"hide-details":""},null,8,["modelValue","items"])])]),_:1}),r(W,null,{default:f(()=>[r(z),r(b,{onClick:o[16]||(o[16]=n=>V.value=!1),class:"tw-mr-2",color:"error"},{default:f(()=>[M(w(d(t)("close")),1)]),_:1}),r(b,{onClick:G,disabled:!1,loading:C.value,color:"primary",variant:"flat"},{default:f(()=>[M(w(d(t)("save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Se={class:"tw-block tw-justify-between tw-p-3 md:tw-flex md:tw-px-6"},Fe={class:"tw-block md:tw-flex"},Pe=U({__name:"CalendarBar",emits:["update"],setup($,{emit:a}){const{t}=O(),l=N(),i=a;return(c,y)=>(h(),T(S,{elevation:"10",class:"tw-mb-6"},{default:f(()=>[u("div",Se,[u("div",null,[d(l).user.type==="Therapist"?(h(),T(Z,{key:0,onUpdate:y[0]||(y[0]=p=>i("update")),title:d(t)("sessions.newSession")},null,8,["title"])):A("",!0)]),u("div",Fe,[r(ve),d(l).user.type==="Therapist"?(h(),T(Ne,{key:0,onUpdate:y[1]||(y[1]=p=>i("update"))})):A("",!0)])])]),_:1}))}}),Re={class:"tw-relative tw-flex tw-items-center tw-rounded-md tw-bg-white border-sm md:tw-items-stretch"},Ae={class:"tw-sr-only"},Le={class:"tw-sr-only"},Qe=U({__name:"CalendarPagination",emits:["back","nextMonth","previousMonth"],setup($,{emit:a}){const{t}=O(),l=a;return(i,c)=>{const y=I("ChevronLeftIcon"),p=I("ChevronRightIcon");return h(),k("div",Re,[u("button",{onClick:c[0]||(c[0]=m=>l("previousMonth")),type:"button",class:"tw-flex tw-h-9 tw-w-9 tw-items-center tw-justify-center tw-rounded-l-md tw-text-gray-400 hover:tw-text-gray-500 focus:tw-relative md:tw-w-9 md:tw-pr-0 md:hover:tw-bg-gray-50"},[u("span",Ae,w(d(t)("calendar.previousDay")),1),r(y,{"aria-hidden":"true",class:"tw-h-5 tw-w-5"})]),u("button",{onClick:c[1]||(c[1]=m=>l("back")),type:"button",class:"tw-border-solid tw-border-l tw-hidden tw-border-r tw-border-gray-100 tw-px-3.5 tw-text-sm tw-font-semibold tw-text-gray-900 hover:tw-bg-gray-50 focus:tw-relative md:tw-block"},w(d(t)("month")),1),c[3]||(c[3]=u("span",{class:"tw-relative tw--mx-px tw-h-5 tw-w-px tw-bg-gray-300 md:tw-hidden"},null,-1)),u("button",{onClick:c[2]||(c[2]=m=>l("nextMonth")),type:"button",class:"tw-flex tw-h-9 tw-w-9 tw-items-center tw-justify-center tw-rounded-r-md tw-border-y tw-border-r tw-border-gray-300 tw-text-gray-400 hover:tw-text-gray-500 focus:tw-relative md:tw-w-9 md:tw-pl-0 md:hover:tw-bg-gray-50"},[u("span",Le,w(d(t)("calendar.nextDay")),1),r(p,{class:"tw-h-5 tw-w-5","aria-hidden":"true"})])])}}});export{Ee as C,Qe as _,Pe as a};
