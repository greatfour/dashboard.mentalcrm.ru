import{_ as G}from"./login-bg-BUNgFWo8.js";import{_ as J}from"./Logo.vue_vue_type_script_setup_true_lang-DjWCzRFd.js";import{d as P,u as W,g as X,h as Y,k as p,n as I,H as T,o as c,c as g,a as u,e as t,t as r,b as l,w as i,am as v,f as m,aK as Z,s as ee,V,q as te,an as y,m as f,p as b,aN as ae,ad as se,F as le,r as C,ag as M,ah as oe}from"./index-rKzDa4TW.js";import{m as ie}from"./index-C-bZKCHr.js";import{u as ue,_ as re}from"./LanguageDD.vue_vue_type_script_setup_true_lang-C-HsXDXv.js";import{_ as ne}from"./BaseButton.vue_vue_type_style_index_0_lang-CDExAE8N.js";import{u as de}from"./Rules-DZKrv_I-.js";import"./moment-zH0z38ay.js";const me={class:"tw-align-center px-sm-7 tw-flex tw-justify-end tw-px-4"},pe={class:"tw-align-center tw-flex tw-h-full tw-justify-center"},ce={class:"tw-align-center mt-xl-0 px-sm-7 tw-mt-5 tw-flex tw-w-full tw-flex-col tw-justify-center tw-px-4"},ve={class:"text-h3 font-weight-bold mb-2"},fe={class:"text-subtitle-1 mb-6"},we={key:0},_e={class:"tw-mb-1 tw-flex tw-items-center tw-justify-between"},ye={class:"tw-flex tw-items-start"},he={class:"tw-flex tw-items-start"},ge={class:"tw-flex tw-items-center"},xe={class:"tw-mb-0.5"},Ve=["href"],be={key:1,class:"text-error tw-text-base"},Ce={key:2,class:"text-error tw-text-base"},ke={class:"text-h6 text-medium-emphasis d-flex align-center mt-6"},Ne=P({__name:"RegisterForm",setup(B){const{t:s}=W(),n=X(),L=Y(),q=ue(),{nameRules:R,codeRules:j,emailRules:F,passwordRules:z,emptyRules:A}=de(),k=p(!1),x=p(!1),w=p(!1),_=p(!1),$=p(""),N=p(!1),U=p(!1),e=p({email:"",password:"",firstName:"",lastName:"",therapistCode:"",inviteCode:"",type:null,zoneId:ie.tz.guess()}),O=I(()=>"https://dashboard.mentalcrm.ru"),Q=I(()=>[{title:s("auth.client"),props:{value:"Client"}},{title:s("auth.therapist"),props:{value:"Therapist"}}]),D=p([d=>!!d||s("validation.passwordEmpty"),d=>d&&d.length>=8||s("validation.password"),d=>d&&d===e.value.password||s("validation.repeatPassword")]);T(e,()=>{N.value=!1}),T(()=>e.value.type,async(d,a)=>{console.log("ewa"),d||(a?e.value.type=a:e.value.type===null?e.value.type=null:e.value.type="Client")},{immediate:!0});const H=async()=>{var d,a;x.value=!0;try{e.value.type==="Client"?await q.registerApi({...e.value,therapistCode:e.value.therapistCode}):await q.registerApi({email:e.value.email,password:e.value.password,firstName:e.value.firstName,lastName:e.value.lastName,type:e.value.type,inviteCode:e.value.inviteCode}),x.value=!1,L.push({name:"login",query:{email:e.value.email}})}catch(h){((a=(d=h==null?void 0:h.response)==null?void 0:d.data)==null?void 0:a.detail)==="User already exists"?U.value=!0:N.value=!0,x.value=!1}};return n.query.code&&(e.value.therapistCode=String(n.query.code),e.value.type="Client"),n.query.inviteCode&&(e.value.inviteCode=String(n.query.inviteCode),e.value.type="Therapist"),n.query.email&&(e.value.email=String(n.query.email)),n.query.lastName&&(e.value.lastName=String(n.query.lastName)),n.query.firstName&&(e.value.firstName=String(n.query.firstName)),(d,a)=>{const h=C("QuestionMarkIcon"),S=C("EyeIcon"),E=C("EyeOffIcon"),K=C("RouterLink");return c(),g(le,null,[u("div",me,[t(re)]),u("div",pe,[u("div",ce,[u("h2",ve,r(l(s)("auth.registerTitle")),1),u("div",fe,r(l(s)("auth.loginSubTitle")),1),t(se,{modelValue:k.value,"onUpdate:modelValue":a[9]||(a[9]=o=>k.value=o),class:"mt-5","lazy-validation":""},{default:i(()=>[t(v,{class:"text-subtitle-1 font-weight-medium tw-mb-3"},{default:i(()=>[m(r(l(s)("sessions.type")),1)]),_:1}),t(Z,{items:Q.value,modelValue:e.value.type,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.type=o)},null,8,["items","modelValue"]),e.value.type==="Client"?(c(),g("div",we,[u("div",_e,[t(v,{class:"text-subtitle-1 font-weight-medium"},{default:i(()=>[m(r(l(s)("auth.therapistCode")),1)]),_:1}),t(ee,{text:l(s)("auth.clientCodeMessage")},{activator:i(({props:o})=>[t(V,te(o,{size:"x-small",class:"tw-scale-75",color:"primary",variant:"tonal",icon:""}),{default:i(()=>[t(h)]),_:2},1040)]),_:1},8,["text"])]),t(y,{modelValue:e.value.therapistCode,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.therapistCode=o),rules:l(j),type:"text",required:""},null,8,["modelValue","rules"])])):f("",!0),t(v,{class:"text-subtitle-1 font-weight-medium tw-mb-3"},{default:i(()=>[m(r(l(s)("auth.firstname")),1)]),_:1}),t(y,{modelValue:e.value.firstName,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.firstName=o),rules:l(R),type:"name",required:""},null,8,["modelValue","rules"]),t(v,{class:"text-subtitle-1 font-weight-medium tw-mb-3"},{default:i(()=>[m(r(l(s)("auth.lastname")),1)]),_:1}),t(y,{modelValue:e.value.lastName,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.lastName=o),rules:l(R),type:"name",required:""},null,8,["modelValue","rules"]),t(v,{class:"text-subtitle-1 font-weight-medium tw-mb-3"},{default:i(()=>[m(r(l(s)("auth.resetEmail")),1)]),_:1}),t(y,{modelValue:e.value.email,"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.email=o),rules:l(F),type:"email",required:""},null,8,["modelValue","rules"]),t(v,{class:"text-subtitle-1 font-weight-medium tw-mb-3"},{default:i(()=>[m(r(l(s)("auth.password")),1)]),_:1}),u("div",ye,[t(y,{modelValue:e.value.password,"onUpdate:modelValue":a[5]||(a[5]=o=>e.value.password=o),type:w.value?"text":"password",rules:l(z),class:"tw-mr-3",color:"primary",variant:"outlined",required:""},null,8,["modelValue","type","rules"]),t(V,{onClick:a[6]||(a[6]=o=>w.value=!w.value),color:w.value?"info":"default",variant:"tonal",icon:""},{default:i(()=>[w.value?(c(),b(S,{key:0})):f("",!0),w.value?f("",!0):(c(),b(E,{key:1}))]),_:1},8,["color"])]),t(v,{class:"text-subtitle-1 font-weight-medium tw-mb-3"},{default:i(()=>[m(r(l(s)("auth.repeatPassword")),1)]),_:1}),u("div",he,[t(y,{modelValue:$.value,"onUpdate:modelValue":a[7]||(a[7]=o=>$.value=o),rules:D.value,type:_.value?"text":"password",color:"primary",class:"tw-mr-3",variant:"outlined",required:""},null,8,["modelValue","rules","type"]),t(V,{onClick:a[8]||(a[8]=o=>_.value=!_.value),color:_.value?"info":"default",variant:"tonal",icon:""},{default:i(()=>[_.value?(c(),b(S,{key:0})):f("",!0),_.value?f("",!0):(c(),b(E,{key:1}))]),_:1},8,["color"])]),u("div",ge,[t(ae,{rules:l(A),color:"primary",required:"","hide-details":""},{label:i(()=>[u("p",xe,[m(r(l(s)("auth.agree"))+" ",1),u("a",{class:"text-primary tw-font-semibold",href:`${O.value}/legislation/tandc`},r(l(s)("auth.agreeLink")),9,Ve)])]),_:1},8,["rules"])]),t(ne,{loading:x.value,disabled:!(k.value&&e.value.type),onClick:H,class:"tw-mb-1 tw-mt-2"},{default:i(()=>[m(r(l(s)("auth.signUp")),1)]),_:1},8,["loading","disabled"]),N.value?(c(),g("p",be,r(l(s)("auth.errorMessageRegister")),1)):f("",!0),U.value?(c(),g("p",Ce,r(l(s)("auth.errorMessageEmailRegister")),1)):f("",!0)]),_:1},8,["modelValue"]),u("h6",ke,[m(r(l(s)("auth.registerLoginTitle"))+" ",1),t(K,{to:{name:"login"}},{default:i(()=>[t(V,{variant:"plain",class:"text-primary text-body-1 opacity-1 pl-2"},{default:i(()=>[m(r(l(s)("auth.registerLoginBtn")),1)]),_:1})]),_:1})])])])],64)}}}),qe={class:"pa-3"},Re={class:"auth-header pt-lg-6 px-sm-6 pb-lg-6 px-3 py-2"},$e={class:"position-relative"},Ue={class:"auth__block"},je=P({__name:"Register",setup(B){return(s,n)=>(c(),g("div",qe,[t(oe,{class:"h-100vh mh-100 auth"},{default:i(()=>[t(M,{cols:"12",lg:"7",xl:"8",class:"d-lg-flex align-center authentication position-relative justify-center"},{default:i(()=>[u("div",Re,[u("div",$e,[t(J)])]),n[0]||(n[0]=u("div",null,[u("img",{src:G,class:"position-relative d-none d-lg-flex",alt:"login-background"})],-1))]),_:1}),t(M,{cols:"12",lg:"5",xl:"4"},{default:i(()=>[u("div",Ue,[t(Ne)])]),_:1})]),_:1})]))}});export{je as default};
